<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS设计模式 | PENG BlOG </title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="何为设计
即按照一种思路或者标准来实现功能
功能相同，可以由不同设计方案来实现
伴随需求的增加，设计的作用才能体现出来
UNIX/LINUX设计思想
参考文献 《UNIX/LINUX设计思想》
准则1: 小即是美 ...">
    <link rel="preload" href="/assets/css/0.styles.3b407bb1.css" as="style"><link rel="preload" href="/assets/js/app.2081b9de.js" as="script"><link rel="preload" href="/assets/js/6.e971b65b.js" as="script"><link rel="preload" href="/assets/js/3.7df72e40.js" as="script"><link rel="preload" href="/assets/js/16.206b99e7.js" as="script"><link rel="prefetch" href="/assets/js/10.28ca56ae.js"><link rel="prefetch" href="/assets/js/11.7155161e.js"><link rel="prefetch" href="/assets/js/12.a8cde50f.js"><link rel="prefetch" href="/assets/js/13.f25c2b77.js"><link rel="prefetch" href="/assets/js/14.c5433b85.js"><link rel="prefetch" href="/assets/js/15.54d3db27.js"><link rel="prefetch" href="/assets/js/17.a2541f66.js"><link rel="prefetch" href="/assets/js/18.1a930651.js"><link rel="prefetch" href="/assets/js/4.970cf5ac.js"><link rel="prefetch" href="/assets/js/5.1c80739e.js"><link rel="prefetch" href="/assets/js/7.01076be7.js"><link rel="prefetch" href="/assets/js/8.4092820b.js"><link rel="prefetch" href="/assets/js/9.3b9ad554.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.3fc622a1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3b407bb1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">PENG BlOG  </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">文章</a></li><li class="nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="nav-item"><a href="http://tjui.glinsunai.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external">组件库</a></li><li class="nav-item"><a href="https://github.com/myronyang" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">PENG BlOG  </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">文章</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="mobile-nav-item"><a href="http://tjui.glinsunai.com/#/" target="_blank" rel="noopener noreferrer" class="nav-link external">组件库</a></li><li class="mobile-nav-item"><a href="https://github.com/myronyang" target="_blank" rel="noopener noreferrer" class="nav-link external">Github</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        JS设计模式
      </h1> <div class="post-meta"><!----> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2019-4-5">
      Fri Apr 05 2019
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/tag/Javascript" data-v-42ccfcd5><span data-v-42ccfcd5>Javascript</span></a></li><li class="post-tag" data-v-42ccfcd5><a href="/tag/设计模式" data-v-42ccfcd5><span data-v-42ccfcd5>设计模式</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="设计原则"><a href="#设计原则" class="header-anchor">#</a> 设计原则</h2> <h3 id="何为设计"><a href="#何为设计" class="header-anchor">#</a> 何为设计</h3> <ul><li>即按照一种思路或者标准来实现功能</li> <li>功能相同，可以由不同设计方案来实现</li> <li>伴随需求的增加，设计的作用才能体现出来</li></ul> <h3 id="unix-linux设计思想"><a href="#unix-linux设计思想" class="header-anchor">#</a> UNIX/LINUX设计思想</h3> <p>参考文献 <a href="https://download.csdn.net/download/kxjrzyk/10868478" target="_blank" rel="noopener noreferrer">《UNIX/LINUX设计思想》<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="准则1-小即是美"><a href="#准则1-小即是美" class="header-anchor">#</a> 准则1: 小即是美</h4> <h4 id="准则2-让每个程序只做好一件事"><a href="#准则2-让每个程序只做好一件事" class="header-anchor">#</a> 准则2: 让每个程序只做好一件事</h4> <p><font color="#999">把每个子程序做的足够小，实现单一功能，大程序是各个小程序的集合。</font></p> <h4 id="准则3-快速建立原型"><a href="#准则3-快速建立原型" class="header-anchor">#</a> 准则3: 快速建立原型</h4> <p><font color="#999">不管产品还是程序，先实现基本功能，再一步步扩展。</font></p> <h4 id="准则4-舍弃高效率而取可移植性"><a href="#准则4-舍弃高效率而取可移植性" class="header-anchor">#</a> 准则4: 舍弃高效率而取可移植性</h4> <p><font color="#999">例如组件或插件的通用性优先级高于高效性，长远看同个组件适用多个项目，将节省大量成本。</font></p> <h4 id="准则5-采用纯文本来储层数据"><a href="#准则5-采用纯文本来储层数据" class="header-anchor">#</a> 准则5: 采用纯文本来储层数据</h4> <p><font color="#999">在效率和可读性上的取舍。</font></p> <h4 id="准则6-充分利用软件的杠杆效应-软件复用"><a href="#准则6-充分利用软件的杠杆效应-软件复用" class="header-anchor">#</a> 准则6: 充分利用软件的杠杆效应（软件复用）</h4> <h4 id="准则7-使用shell脚本来提高杠杆效应和可移植性"><a href="#准则7-使用shell脚本来提高杠杆效应和可移植性" class="header-anchor">#</a> 准则7: 使用shell脚本来提高杠杆效应和可移植性</h4> <h4 id="准则8-避免强制性的用户界面"><a href="#准则8-避免强制性的用户界面" class="header-anchor">#</a> 准则8: 避免强制性的用户界面</h4> <h4 id="准则9-让每个程序都称为过滤器"><a href="#准则9-让每个程序都称为过滤器" class="header-anchor">#</a> 准则9: 让每个程序都称为过滤器</h4> <h4 id="精简设计思想中的小准则"><a href="#精简设计思想中的小准则" class="header-anchor">#</a> <font color="#9c27b0">精简设计思想中的小准则</font></h4> <h4 id="小准则-允许用户定制环境"><a href="#小准则-允许用户定制环境" class="header-anchor">#</a> 小准则：允许用户定制环境</h4> <h4 id="小准则-尽量使操作系统内核小而轻量化"><a href="#小准则-尽量使操作系统内核小而轻量化" class="header-anchor">#</a> 小准则：尽量使操作系统内核小而轻量化</h4> <h4 id="小准则-使用小写字母尽量缩短"><a href="#小准则-使用小写字母尽量缩短" class="header-anchor">#</a> 小准则：使用小写字母尽量缩短</h4> <h4 id="小准则-沉默是金"><a href="#小准则-沉默是金" class="header-anchor">#</a> 小准则：沉默是金</h4> <h4 id="小准则-各部分之和大于整体"><a href="#小准则-各部分之和大于整体" class="header-anchor">#</a> 小准则：各部分之和大于整体</h4> <h4 id="小准则-需求90-的解决方案"><a href="#小准则-需求90-的解决方案" class="header-anchor">#</a> 小准则：需求90%的解决方案</h4> <p><font color="#999">例如二八定律，花20%的成本解决80%的需求</font></p> <h2 id="solid五大设计原则"><a href="#solid五大设计原则" class="header-anchor">#</a> SOLID五大设计原则</h2> <h4 id="s-单一职责原则"><a href="#s-单一职责原则" class="header-anchor">#</a> S-单一职责原则</h4> <ul><li>一个程序只做好一件事</li> <li>如果功能过于复杂就拆分开，每个部分保持独立</li></ul> <h4 id="o-开放封闭原则"><a href="#o-开放封闭原则" class="header-anchor">#</a> O-开放封闭原则</h4> <ul><li>对扩展开放，对修改封闭</li> <li>怎加需求时，扩展新代码，而非修改已有代码</li></ul> <h4 id="l-李氏置换原则"><a href="#l-李氏置换原则" class="header-anchor">#</a> L-李氏置换原则</h4> <ul><li>子类能覆盖父类</li> <li>父类能出现的地方子类就能出现</li> <li>JS中使用较少（弱类型&amp;继承使用较少）</li></ul> <h4 id="i-接口独立原则"><a href="#i-接口独立原则" class="header-anchor">#</a> I-接口独立原则</h4> <ul><li>保持接口的单一独立，避免出现“胖接口”</li> <li>JS中没有接口（typescript除外），使用较少</li> <li>类型单一职责原理，这里更关注接口</li></ul> <h4 id="d-依赖倒置原则"><a href="#d-依赖倒置原则" class="header-anchor">#</a> D-依赖倒置原则</h4> <ul><li>面向接口编程，依赖于抽象而不依赖具体</li> <li>使用方只关注接口而不关注具体类的实现</li> <li>JS中使用较少（弱类型&amp;没有接口）</li></ul> <p>::: warning
前端SO体现较多，重点理解，LID体现较少，但可了解其用意。
:::</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">loadImg</span> <span class="token operator">=</span> <span class="token parameter">src</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
		img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">resolve</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'加载失败'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
		img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> src <span class="token operator">=</span> <span class="token string">&quot; ... img path&quot;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">loadImg</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span>

result<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'img.width'</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>width<span class="token punctuation">)</span>
	<span class="token keyword">return</span> img
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">img</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'img.height'</span><span class="token punctuation">,</span> img<span class="token punctuation">.</span>height<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>从以上代码体现：</p> <ul><li>单一职责原则：在每个<code>then</code>中只做好一件事</li> <li>开放封闭原则：如果有新需求我们只需扩展<code>then</code></li></ul> <h2 id="设计模式"><a href="#设计模式" class="header-anchor">#</a> 设计模式</h2> <h4 id="创建型"><a href="#创建型" class="header-anchor">#</a> 创建型</h4> <p><font color="#999">这几种模式主要是对象该如何创建出来</font></p> <ul><li>工厂模式（工厂方法模式, 抽象工厂模式, 建造者模式）</li> <li>单例模式</li> <li>原型模式</li></ul> <h4 id="组合型"><a href="#组合型" class="header-anchor">#</a> 组合型</h4> <p><font color="#999">类和对象该是怎样的组合形式</font></p> <ul><li>适配器模式</li> <li>装饰器模式</li> <li>代理模式</li> <li>外观模式</li></ul> <h4 id="行为型"><a href="#行为型" class="header-anchor">#</a> 行为型</h4> <p><font color="#999">这几种设计模式涵盖日常开发中常用行为</font></p> <ul><li>观察者模式</li> <li>迭代器模式</li> <li>状态模式</li></ul> <h3 id="工厂模式"><a href="#工厂模式" class="header-anchor">#</a> 工厂模式</h3> <p>工厂模式是我们最常用的实例化对象模式，是用工厂方法代替new操作的一种模式。因为工厂模式就相当于创建实例对象的new，我们经常要根据类Class生成实例对象，如A a=new A() 工厂模式也是用来创建实例对象的，所以以后new时就注意，是否可以考虑使用工厂模式。</p> <p><img src="http://gxzn-free.oss-cn-zhangjiakou.aliyuncs.com/Web-private-resource/Blog/designs/1.png" alt="工厂模式"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Product</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'init'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'fn1'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Creator</span> <span class="token punctuation">{</span>
    <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Product</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> creator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Creator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> creator<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>我们只需要creator.create能生成一个实例，而不用关心Product的具体逻辑。</p> <h4 id="实际应用"><a href="#实际应用" class="header-anchor">#</a> 实际应用</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">jQuery</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> slice <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>slice
        <span class="token keyword">let</span> dom <span class="token operator">=</span> <span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> len <span class="token operator">=</span> dom <span class="token operator">?</span> dom<span class="token punctuation">.</span>length <span class="token operator">:</span> <span class="token number">0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> dom<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>length <span class="token operator">=</span> len
        <span class="token keyword">this</span><span class="token punctuation">.</span>selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
    <span class="token function">append</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token function">addClass</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token function">html</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token comment">// 此处省略若干 API</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function-variable function">$</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">jQuery</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>想象一下如果jQuery没有使用工厂模式</p> <ul><li>$('div')将要写成 new jQuery(selector)代码作将变得繁琐</li> <li>一旦构造函数jQuery有变化，使用者也要改变</li></ul> <h4 id="设计原则验证"><a href="#设计原则验证" class="header-anchor">#</a> 设计原则验证：</h4> <ul><li>工造函数和创建者分离</li> <li>符合开放封闭原则</li></ul> <h3 id="单例模式"><a href="#单例模式" class="header-anchor">#</a> 单例模式</h3> <p>单例模式，是一种常用的软件设计模式。在它的核心结构中只包含一个被称为单例的特殊类。通过单例模式可以保证系统中，应用该模式的类一个类只有一个实例。即一个类只有一个对象实例。</p> <p><img src="http://gxzn-free.oss-cn-zhangjiakou.aliyuncs.com/Web-private-resource/Blog/designs/1.jpg" alt="单例模式"></p> <p>单例模式用到了 java 的一些特性，而 es6 没有这些特性，因此只能用 java 进行演示。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingleObject</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注意，私有化构造函数，外部不能 new ，只能内部能 new ！！！！</span>
    <span class="token keyword">private</span> <span class="token function">SingleObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 唯一被 new 出来的对象</span>
    <span class="token keyword">private</span> SingleObject instance <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token comment">// 获取对象的唯一接口</span>
    <span class="token keyword">public</span> SingleObject <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 只 new 一次</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 对象方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;login...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>单例模式的关键在于不能让外部使用者 new 出对象，即构造函数是 private ，这一点 JS 是无法实现的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">SingleObject</span> <span class="token punctuation">{</span>
    <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'login...'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
SingleObject<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> instance
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingleObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 测试：注意这里只能使用静态函数 getInstance ，不能 new SingleObject() ！！！</span>
<span class="token keyword">let</span> obj1 <span class="token operator">=</span> SingleObject<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj1<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> SingleObject<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj2<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1 <span class="token operator">===</span> obj2<span class="token punctuation">)</span>  <span class="token comment">// 两者必须完全相等</span>
</code></pre></div><h4 id="实际应用-2"><a href="#实际应用-2" class="header-anchor">#</a> 实际应用</h4> <p>日常使用中，很多都用到了单例的思想，但是不一定完全按照单例的类图来实现：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// jQuery 只有一个 `$`</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>jQuery <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> window<span class="token punctuation">.</span>jQuery
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 初始化...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>模拟实现一个登录框</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">LoginForm</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'hide'</span>
    <span class="token punctuation">}</span>
    <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'show'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'已经显示'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'show'</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'登录框已显示'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">'hide'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'已经隐藏'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'hide'</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'登录框已隐藏'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
LoginForm<span class="token punctuation">.</span>getInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> instance
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LoginForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 一个页面中调用登录框</span>
<span class="token keyword">let</span> login1 <span class="token operator">=</span> LoginForm<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
login1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// login1.hide()</span>

<span class="token comment">// 另一个页面中调用登录框</span>
<span class="token keyword">let</span> login2 <span class="token operator">=</span> loginForm<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
login2<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 两者是否相等</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'login1 === login2'</span><span class="token punctuation">,</span> login1 <span class="token operator">===</span> login2<span class="token punctuation">)</span>
</code></pre></div><ul><li>购物车，和登录框实现方式差不多</li> <li>所有弹框遮罩层只有一个实例</li></ul> <h4 id="单例模式-vs-单一职责原则"><a href="#单例模式-vs-单一职责原则" class="header-anchor">#</a> 单例模式 vs 单一职责原则</h4> <ul><li>单一职责原则是针对所有的设计，单个功能尽量拆分，一个模块做好一个功能。如果做不好，会带来模块臃肿，不好维护</li> <li>单例模式是系统的只能有一份唯一的数据，如果不这样做，会出 bug 的</li></ul> <h4 id="设计原则验证-2"><a href="#设计原则验证-2" class="header-anchor">#</a> 设计原则验证</h4> <ul><li>符合单一职责原则，只实例化唯一的对象</li> <li>没法具体开放封闭原则，但是绝对不违反开放封闭原则</li></ul> <h3 id="适配器模式"><a href="#适配器模式" class="header-anchor">#</a> 适配器模式</h3> <p>将一个类的接口适配成用户所期待的。一个适配允许通常因为接口不兼容而不能在一起工作的类工作在一起，做法是将类自己的接口包裹在一个已存在的类中。</p> <p><img src="http://gxzn-free.oss-cn-zhangjiakou.aliyuncs.com/Web-private-resource/Blog/designs/1.png" alt="适配器模式"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Adaptee</span> <span class="token punctuation">{</span>
    <span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'德国标准的插头'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Target</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>adaptee <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Adaptee</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> info <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>adaptee<span class="token punctuation">.</span><span class="token function">specificRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>info<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> -&gt; 转换器 -&gt; 中国标准的插头</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试</span>
<span class="token keyword">let</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Target</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
target<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="实际应用-3"><a href="#实际应用-3" class="header-anchor">#</a> 实际应用</h4> <p>随着前端框架的发展，越来越多的开发者开始使用MVVM框架进行开发，只需要操作数据而不需要操作DOM元素，jQuery的作用越来越少。而很多项目中还是引用着jQuery库作用工具类，因为我们要利用jQuery提供的ajax去服务器请求数据。如果jQuery在项目中的作用仅仅是作为ajax工具库的话，有点杀鸡焉用牛刀的感觉，造成资源浪费。这个时候我们完全可以封装一个自己的ajax库。 假设我们封装的ajax就通过一个函数进行使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 自己封装的 ajax ，使用方式如下：</span>
<span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span><span class="token string">'/getData'</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span><span class="token string">'Post'</span><span class="token punctuation">,</span>
    dataType<span class="token operator">:</span><span class="token string">'json'</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span>
        id<span class="token operator">:</span><span class="token string">&quot;123&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 但因为历史原因，代码中全都是：</span>
<span class="token comment">// $.ajax({...})</span>
</code></pre></div><p>除了调用接口ajax与jQuery的$.ajax的不同，其他完全一样。 项目中请求ajax的地方必然很多，我们替换jQuery的时候不可能一个一个去修改$.ajax，那怎么办呢，这个时候，我们就可以增加一个适配器：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 做一层适配器</span>
<span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">ajax</span><span class="token operator">:</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">ajax</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="设计原则验证-3"><a href="#设计原则验证-3" class="header-anchor">#</a> 设计原则验证</h4> <ul><li>将现有接口和使用者进行分离</li> <li>符合开放封闭原则</li></ul> <h3 id="装饰器模式"><a href="#装饰器模式" class="header-anchor">#</a> 装饰器模式</h3> <p>装饰器模式（Decorator Pattern）允许向一个现有的对象添加新的功能，同时又不改变其结构。这种类型的设计模式属于结构型模式，它是作为现有的类的一个包装。动态地给一个对象添加一些额外的职责。就增加功能来说，装饰器模式相比生成子类更为灵活。</p> <p><img src="http://gxzn-free.oss-cn-zhangjiakou.aliyuncs.com/Web-private-resource/Blog/designs/1.jpg" alt="装饰器模式"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Circle</span> <span class="token punctuation">{</span>
    <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'画一个原型'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Decorator</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">circle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>circle <span class="token operator">=</span> circle
    <span class="token punctuation">}</span>
    <span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>circle<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setRedBoder</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">setRedBoder</span><span class="token punctuation">(</span><span class="token parameter">circle</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'设置红色边框'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 测试代码</span>
<span class="token keyword">let</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Circle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
circle<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> dec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decorator</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span>  <span class="token comment">// 装饰</span>
dec<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="实际应用-4"><a href="#实际应用-4" class="header-anchor">#</a> 实际应用</h4> <p>就 ES7 标准中增加的装饰器来体会一下装饰器模式在 JS 中的应用。</p> <p>如果node -v是6.x版本的话，要安装npm i babel-plugin-transform-decorators-legacy --save-dev，然后修改.babrlrc</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;latest&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;transform-decorators-legacy&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="es7-装饰器"><a href="#es7-装饰器" class="header-anchor">#</a> ES7 装饰器</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一个简单的 demo</span>
@testDec
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">testDec</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  target<span class="token punctuation">.</span>isDec <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span>Demo<span class="token punctuation">.</span>isDec<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>可以加参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 可以加参数</span>
<span class="token keyword">function</span> <span class="token function">testDec</span><span class="token punctuation">(</span><span class="token parameter">isDec</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    target<span class="token punctuation">.</span>isDec <span class="token operator">=</span> isDec<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@<span class="token function">testDec</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token function">alert</span><span class="token punctuation">(</span>Demo<span class="token punctuation">.</span>isDec<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>装饰器的原理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 装饰器的原理</span>

@decorator
<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 等同于</span>

<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token constant">A</span> <span class="token operator">=</span> <span class="token function">decorator</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">A</span><span class="token punctuation">;</span>
</code></pre></div><p>最后一个示例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">mixins</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token operator">...</span>list<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> Foo <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

@<span class="token function">mixins</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MyClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 'foo'</span>
</code></pre></div><h4 id="装饰方法"><a href="#装饰方法" class="header-anchor">#</a> 装饰方法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">readonly</span><span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> name<span class="token punctuation">,</span> descriptor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// descriptor 属性描述对象（Object.defineProperty 中会用到），原来的值如下</span>
  <span class="token comment">// {</span>
  <span class="token comment">//   value: specifiedFunction,</span>
  <span class="token comment">//   enumerable: false,</span>
  <span class="token comment">//   configurable: true,</span>
  <span class="token comment">//   writable: true</span>
  <span class="token comment">// };</span>
  descriptor<span class="token punctuation">.</span>writable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> descriptor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>first <span class="token operator">=</span> <span class="token string">'A'</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>last <span class="token operator">=</span> <span class="token string">'B'</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 装饰方法</span>
    @readonly
    <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>last<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// p.name = function () {} // 这里会报错，因为 name 是只读属性</span>
</code></pre></div><h4 id="设计原则验证-4"><a href="#设计原则验证-4" class="header-anchor">#</a> 设计原则验证</h4> <ul><li>将现有对象和装饰器进行分离，两者独立存在</li> <li>符合开放封闭原则</li></ul></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#设计原则" title="设计原则">设计原则</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#何为设计" title="何为设计">何为设计</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#unix-linux设计思想" title="UNIX/LINUX设计思想">UNIX/LINUX设计思想</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#solid五大设计原则" title="SOLID五大设计原则">SOLID五大设计原则</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#设计模式" title="设计模式">设计模式</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#工厂模式" title="工厂模式">工厂模式</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#单例模式" title="单例模式">单例模式</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#适配器模式" title="适配器模式">适配器模式</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#装饰器模式" title="装饰器模式">装饰器模式</a></div></div></div></div> <footer class="footer" data-v-fdbf4940><div class="footer-left-wrap" data-v-fdbf4940><ul class="contact" data-v-fdbf4940><li class="contact-item" data-v-fdbf4940><a href="https://github.com/myronyang" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-fdbf4940><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-fdbf4940><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-fdbf4940></path></svg>
          
        </a></li><li class="contact-item" data-v-fdbf4940><a href="/2019/04/05/javascript-design/821253835@qq.com.html" class="nav-link" data-v-fdbf4940><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-fdbf4940><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-fdbf4940></path><polyline points="22,6 12,13 2,6" data-v-fdbf4940></polyline></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-fdbf4940><ul class="copyright" data-v-fdbf4940><li class="copyright-item" data-v-fdbf4940><a href="/2019/04/05/javascript-design/.html" class="nav-link" data-v-fdbf4940>MyronYang © 2020</a></li></ul></div></footer></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.2081b9de.js" defer></script><script src="/assets/js/6.e971b65b.js" defer></script><script src="/assets/js/3.7df72e40.js" defer></script><script src="/assets/js/16.206b99e7.js" defer></script>
  </body>
</html>
